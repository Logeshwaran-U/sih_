<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>3D Generator</title>
    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 1rem;
      }
      model-viewer {
        width: 640px;
        height: 480px;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    <h1>Generate 3D Model</h1>
    <input
      id="prompt"
      placeholder="Enter prompt (e.g. 'cute robot, cartoon, low-poly')"
      size="60"
    />
    <button id="genBtn">Generate</button>
    <p id="status"></p>

    <model-viewer
      id="viewer"
      camera-controls
      auto-rotate
      exposure="1"
    ></model-viewer>

    <script>
      async function generate() {
        const prompt = document.getElementById("prompt").value.trim();
        document.getElementById("status").innerText = "";
        if (!prompt) {
          document.getElementById("status").innerText = "Please enter a prompt";
          return;
        }

        document.getElementById("status").innerText =
          "Sending request... (this may take a while)";
        try {
          const res = await fetch("/api/generate-3d/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt }),
          });
          const data = await res.json();
          if (data.model_url) {
            document
              .getElementById("viewer")
              .setAttribute("src", data.model_url);
            document.getElementById("status").innerText = "Model loaded";
          } else {
            document.getElementById("status").innerText =
              "Error: " + (data.error || "unknown");
          }
        } catch (err) {
          document.getElementById("status").innerText =
            "Fetch error: " + err.message;
        }
      }

      document.getElementById("genBtn").addEventListener("click", generate);
    </script>
  </body>
</html>